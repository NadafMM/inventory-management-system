


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > InventoryService</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">com.inventorymanagement.inventory.service</a>
</div>

<h1>Coverage Summary for Class: InventoryService (com.inventorymanagement.inventory.service)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">InventoryService</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (19/19)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    97.4%
  </span>
  <span class="absValue">
    (38/39)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    99.2%
  </span>
  <span class="absValue">
    (119/120)
  </span>
</td>
</tr>
  <tr>
    <td class="name">InventoryService$$SpringCGLIB$$0</td>
  </tr>
  <tr>
    <td class="name">InventoryService$1</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">InventoryService$CurrentStockInfo</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (4/8)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    73.3%
  </span>
  <span class="absValue">
    (11/15)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">InventoryService$StockMovementSummary</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (7/7)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (13/13)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    88.6%
  </span>
  <span class="absValue">
    (31/35)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    97.4%
  </span>
  <span class="absValue">
    (38/39)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    96.6%
  </span>
  <span class="absValue">
    (144/149)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package com.inventorymanagement.inventory.service;
&nbsp;
&nbsp;import com.inventorymanagement.common.exception.EntityNotFoundException;
&nbsp;import com.inventorymanagement.common.exception.ValidationException;
&nbsp;import com.inventorymanagement.inventory.model.InventoryTransaction;
&nbsp;import com.inventorymanagement.inventory.model.Sku;
&nbsp;import com.inventorymanagement.inventory.repository.InventoryTransactionRepository;
&nbsp;import com.inventorymanagement.inventory.repository.SkuRepository;
&nbsp;import jakarta.transaction.Transactional;
&nbsp;import jakarta.validation.constraints.NotNull;
&nbsp;import java.time.LocalDateTime;
&nbsp;import java.util.List;
&nbsp;import org.slf4j.Logger;
&nbsp;import org.slf4j.LoggerFactory;
&nbsp;import org.springframework.beans.factory.annotation.Autowired;
&nbsp;import org.springframework.data.domain.Page;
&nbsp;import org.springframework.data.domain.Pageable;
&nbsp;import org.springframework.stereotype.Service;
&nbsp;import org.springframework.util.StringUtils;
&nbsp;
&nbsp;/**
&nbsp; * Service class for managing inventory transactions and operations. Provides comprehensive
&nbsp; * inventory tracking and audit trail functionality.
&nbsp; */
&nbsp;@Service
&nbsp;@Transactional
&nbsp;public class InventoryService {
&nbsp;
<b class="fc">&nbsp;  private static final Logger logger = LoggerFactory.getLogger(InventoryService.class);</b>
&nbsp;
&nbsp;  private final InventoryTransactionRepository transactionRepository;
&nbsp;  private final SkuRepository skuRepository;
&nbsp;
&nbsp;  @Autowired
&nbsp;  public InventoryService(
<b class="fc">&nbsp;      InventoryTransactionRepository transactionRepository, SkuRepository skuRepository) {</b>
<b class="fc">&nbsp;    this.transactionRepository = transactionRepository;</b>
<b class="fc">&nbsp;    this.skuRepository = skuRepository;</b>
&nbsp;  }
&nbsp;
&nbsp;  // ===== INVENTORY TRANSACTION OPERATIONS =====
&nbsp;
&nbsp;  /**
&nbsp;   * Records a stock-in transaction.
&nbsp;   *
&nbsp;   * @param skuId the SKU ID
&nbsp;   * @param quantity the quantity received
&nbsp;   * @param referenceId the reference ID for the transaction
&nbsp;   * @param reason the reason for the stock-in
&nbsp;   * @param performedBy who performed the transaction
&nbsp;   * @return the created transaction
&nbsp;   */
&nbsp;  public InventoryTransaction recordStockIn(
&nbsp;      @NotNull Long skuId,
&nbsp;      @NotNull Integer quantity,
&nbsp;      String referenceId,
&nbsp;      String reason,
&nbsp;      String performedBy) {
<b class="fc">&nbsp;    logger.info(&quot;Recording stock-in transaction for SKU ID: {}, quantity: {}&quot;, skuId, quantity);</b>
&nbsp;
<b class="fc">&nbsp;    validateTransactionParameters(quantity, &quot;Stock-in&quot;);</b>
<b class="fc">&nbsp;    validatePerformerName(performedBy);</b>
<b class="fc">&nbsp;    validateReferenceId(referenceId);</b>
<b class="fc">&nbsp;    validateReason(reason);</b>
&nbsp;
<b class="fc">&nbsp;    Sku sku = findSkuById(skuId);</b>
&nbsp;
<b class="fc">&nbsp;    InventoryTransaction transaction =</b>
&nbsp;        new InventoryTransaction(
&nbsp;            sku,
&nbsp;            InventoryTransaction.TransactionType.IN,
&nbsp;            quantity,
&nbsp;            referenceId,
&nbsp;            &quot;STOCK_IN&quot;,
&nbsp;            reason,
&nbsp;            performedBy);
&nbsp;
<b class="fc">&nbsp;    InventoryTransaction savedTransaction = transactionRepository.save(transaction);</b>
&nbsp;
<b class="fc">&nbsp;    logger.info(&quot;Successfully recorded stock-in transaction with ID: {}&quot;, savedTransaction.getId());</b>
<b class="fc">&nbsp;    return savedTransaction;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Records a stock-out transaction.
&nbsp;   *
&nbsp;   * @param skuId the SKU ID
&nbsp;   * @param quantity the quantity shipped/sold
&nbsp;   * @param referenceId the reference ID for the transaction
&nbsp;   * @param referenceType the reference type (e.g., &quot;ORDER&quot;, &quot;SHIPMENT&quot;)
&nbsp;   * @param reason the reason for the stock-out
&nbsp;   * @param performedBy who performed the transaction
&nbsp;   * @return the created transaction
&nbsp;   */
&nbsp;  public InventoryTransaction recordStockOut(
&nbsp;      @NotNull Long skuId,
&nbsp;      @NotNull Integer quantity,
&nbsp;      String referenceId,
&nbsp;      String referenceType,
&nbsp;      String reason,
&nbsp;      String performedBy) {
<b class="fc">&nbsp;    logger.info(&quot;Recording stock-out transaction for SKU ID: {}, quantity: {}&quot;, skuId, quantity);</b>
&nbsp;
<b class="fc">&nbsp;    validateTransactionParameters(quantity, &quot;Stock-out&quot;);</b>
<b class="fc">&nbsp;    validatePerformerName(performedBy);</b>
<b class="fc">&nbsp;    validateReferenceId(referenceId);</b>
<b class="fc">&nbsp;    validateReason(reason);</b>
&nbsp;
<b class="fc">&nbsp;    Sku sku = findSkuById(skuId);</b>
&nbsp;
<b class="fc">&nbsp;    InventoryTransaction transaction =</b>
&nbsp;        new InventoryTransaction(
&nbsp;            sku,
&nbsp;            InventoryTransaction.TransactionType.OUT,
&nbsp;            quantity,
&nbsp;            referenceId,
&nbsp;            referenceType,
&nbsp;            reason,
&nbsp;            performedBy);
&nbsp;
<b class="fc">&nbsp;    InventoryTransaction savedTransaction = transactionRepository.save(transaction);</b>
&nbsp;
<b class="fc">&nbsp;    logger.info(</b>
<b class="fc">&nbsp;        &quot;Successfully recorded stock-out transaction with ID: {}&quot;, savedTransaction.getId());</b>
<b class="fc">&nbsp;    return savedTransaction;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Records a stock adjustment transaction.
&nbsp;   *
&nbsp;   * @param skuId the SKU ID
&nbsp;   * @param adjustment the adjustment amount (positive or negative)
&nbsp;   * @param referenceType the reference type for the adjustment
&nbsp;   * @param reason the reason for the adjustment
&nbsp;   * @param performedBy who performed the adjustment
&nbsp;   * @return the created transaction
&nbsp;   */
&nbsp;  public InventoryTransaction recordStockAdjustment(
&nbsp;      @NotNull Long skuId,
&nbsp;      @NotNull Integer adjustment,
&nbsp;      String referenceType,
&nbsp;      String reason,
&nbsp;      String performedBy) {
<b class="fc">&nbsp;    logger.info(</b>
&nbsp;        &quot;Recording stock adjustment transaction for SKU ID: {}, adjustment: {}&quot;, skuId, adjustment);
&nbsp;
<b class="fc">&nbsp;    if (adjustment == 0) {</b>
<b class="fc">&nbsp;      throw new ValidationException(&quot;adjustment&quot;, &quot;Stock adjustment cannot be zero&quot;);</b>
&nbsp;    }
&nbsp;
<b class="fc">&nbsp;    Sku sku = findSkuById(skuId);</b>
&nbsp;
<b class="fc">&nbsp;    InventoryTransaction transaction =</b>
&nbsp;        new InventoryTransaction(
&nbsp;            sku,
&nbsp;            InventoryTransaction.TransactionType.ADJUSTMENT,
&nbsp;            adjustment,
&nbsp;            null,
&nbsp;            referenceType,
&nbsp;            reason,
&nbsp;            performedBy);
&nbsp;
<b class="fc">&nbsp;    InventoryTransaction savedTransaction = transactionRepository.save(transaction);</b>
&nbsp;
<b class="fc">&nbsp;    logger.info(</b>
<b class="fc">&nbsp;        &quot;Successfully recorded stock adjustment transaction with ID: {}&quot;, savedTransaction.getId());</b>
<b class="fc">&nbsp;    return savedTransaction;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Records a stock reservation transaction.
&nbsp;   *
&nbsp;   * @param skuId the SKU ID
&nbsp;   * @param quantity the quantity reserved
&nbsp;   * @param referenceId the reference ID for the reservation
&nbsp;   * @param referenceType the reference type (e.g., &quot;ORDER&quot;, &quot;ALLOCATION&quot;)
&nbsp;   * @param reason the reason for the reservation
&nbsp;   * @param performedBy who performed the reservation
&nbsp;   * @return the created transaction
&nbsp;   */
&nbsp;  public InventoryTransaction recordStockReservation(
&nbsp;      @NotNull Long skuId,
&nbsp;      @NotNull Integer quantity,
&nbsp;      String referenceId,
&nbsp;      String referenceType,
&nbsp;      String reason,
&nbsp;      String performedBy) {
<b class="fc">&nbsp;    logger.info(</b>
&nbsp;        &quot;Recording stock reservation transaction for SKU ID: {}, quantity: {}&quot;, skuId, quantity);
&nbsp;
<b class="fc">&nbsp;    validateTransactionParameters(quantity, &quot;Stock reservation&quot;);</b>
<b class="fc">&nbsp;    validatePerformerName(performedBy);</b>
<b class="fc">&nbsp;    validateReferenceId(referenceId);</b>
<b class="fc">&nbsp;    validateReason(reason);</b>
&nbsp;
<b class="fc">&nbsp;    Sku sku = findSkuById(skuId);</b>
&nbsp;
<b class="fc">&nbsp;    InventoryTransaction transaction =</b>
&nbsp;        new InventoryTransaction(
&nbsp;            sku,
&nbsp;            InventoryTransaction.TransactionType.RESERVED,
&nbsp;            quantity,
&nbsp;            referenceId,
&nbsp;            referenceType,
&nbsp;            reason,
&nbsp;            performedBy);
&nbsp;
<b class="fc">&nbsp;    InventoryTransaction savedTransaction = transactionRepository.save(transaction);</b>
&nbsp;
<b class="fc">&nbsp;    logger.info(</b>
&nbsp;        &quot;Successfully recorded stock reservation transaction with ID: {}&quot;,
<b class="fc">&nbsp;        savedTransaction.getId());</b>
<b class="fc">&nbsp;    return savedTransaction;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Records a stock release transaction.
&nbsp;   *
&nbsp;   * @param skuId the SKU ID
&nbsp;   * @param quantity the quantity released
&nbsp;   * @param referenceId the reference ID for the release
&nbsp;   * @param referenceType the reference type
&nbsp;   * @param reason the reason for the release
&nbsp;   * @param performedBy who performed the release
&nbsp;   * @return the created transaction
&nbsp;   */
&nbsp;  public InventoryTransaction recordStockRelease(
&nbsp;      @NotNull Long skuId,
&nbsp;      @NotNull Integer quantity,
&nbsp;      String referenceId,
&nbsp;      String referenceType,
&nbsp;      String reason,
&nbsp;      String performedBy) {
<b class="fc">&nbsp;    logger.info(</b>
&nbsp;        &quot;Recording stock release transaction for SKU ID: {}, quantity: {}&quot;, skuId, quantity);
&nbsp;
<b class="fc">&nbsp;    validateTransactionParameters(quantity, &quot;Stock release&quot;);</b>
<b class="fc">&nbsp;    validatePerformerName(performedBy);</b>
<b class="fc">&nbsp;    validateReferenceId(referenceId);</b>
<b class="fc">&nbsp;    validateReason(reason);</b>
&nbsp;
<b class="fc">&nbsp;    Sku sku = findSkuById(skuId);</b>
&nbsp;
<b class="fc">&nbsp;    InventoryTransaction transaction =</b>
&nbsp;        new InventoryTransaction(
&nbsp;            sku,
&nbsp;            InventoryTransaction.TransactionType.RELEASED,
&nbsp;            quantity,
&nbsp;            referenceId,
&nbsp;            referenceType,
&nbsp;            reason,
&nbsp;            performedBy);
&nbsp;
<b class="fc">&nbsp;    InventoryTransaction savedTransaction = transactionRepository.save(transaction);</b>
&nbsp;
<b class="fc">&nbsp;    logger.info(</b>
<b class="fc">&nbsp;        &quot;Successfully recorded stock release transaction with ID: {}&quot;, savedTransaction.getId());</b>
<b class="fc">&nbsp;    return savedTransaction;</b>
&nbsp;  }
&nbsp;
&nbsp;  // ===== TRANSACTION QUERY OPERATIONS =====
&nbsp;
&nbsp;  /**
&nbsp;   * Retrieves all transactions for a specific SKU.
&nbsp;   *
&nbsp;   * @param skuId the SKU ID
&nbsp;   * @param pageable pagination information
&nbsp;   * @return page of inventory transactions
&nbsp;   */
&nbsp;  public Page&lt;InventoryTransaction&gt; getTransactionsBySkuId(@NotNull Long skuId, Pageable pageable) {
<b class="fc">&nbsp;    logger.debug(&quot;Retrieving transactions for SKU ID: {}&quot;, skuId);</b>
&nbsp;
&nbsp;    // Verify SKU exists
<b class="fc">&nbsp;    findSkuById(skuId);</b>
&nbsp;
<b class="fc">&nbsp;    return transactionRepository.findBySkuId(skuId, pageable);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Retrieves all transactions for a specific SKU within a date range.
&nbsp;   *
&nbsp;   * @param skuId the SKU ID
&nbsp;   * @param startDate the start date
&nbsp;   * @param endDate the end date
&nbsp;   * @param pageable pagination information
&nbsp;   * @return page of inventory transactions
&nbsp;   */
&nbsp;  public Page&lt;InventoryTransaction&gt; getTransactionsBySkuIdAndDateRange(
&nbsp;      @NotNull Long skuId,
&nbsp;      @NotNull LocalDateTime startDate,
&nbsp;      @NotNull LocalDateTime endDate,
&nbsp;      Pageable pageable) {
<b class="fc">&nbsp;    logger.debug(</b>
&nbsp;        &quot;Retrieving transactions for SKU ID: {} between {} and {}&quot;, skuId, startDate, endDate);
&nbsp;
<b class="pc">&nbsp;    if (startDate.isAfter(endDate)) {</b>
<b class="nc">&nbsp;      throw new ValidationException(&quot;dateRange&quot;, &quot;Start date cannot be after end date&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    // Verify SKU exists
<b class="fc">&nbsp;    findSkuById(skuId);</b>
&nbsp;
<b class="fc">&nbsp;    return transactionRepository.findBySkuIdAndCreatedAtBetween(</b>
&nbsp;        skuId, startDate, endDate, pageable);
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Retrieves all transactions of a specific type.
&nbsp;   *
&nbsp;   * @param transactionType the transaction type
&nbsp;   * @param pageable pagination information
&nbsp;   * @return page of inventory transactions
&nbsp;   */
&nbsp;  public Page&lt;InventoryTransaction&gt; getTransactionsByType(
&nbsp;      @NotNull InventoryTransaction.TransactionType transactionType, Pageable pageable) {
<b class="fc">&nbsp;    logger.debug(&quot;Retrieving transactions of type: {}&quot;, transactionType);</b>
&nbsp;
<b class="fc">&nbsp;    return transactionRepository.findByTransactionType(transactionType, pageable);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Retrieves all transactions within a date range.
&nbsp;   *
&nbsp;   * @param startDate the start date
&nbsp;   * @param endDate the end date
&nbsp;   * @param pageable pagination information
&nbsp;   * @return page of inventory transactions
&nbsp;   */
&nbsp;  public Page&lt;InventoryTransaction&gt; getTransactionsByDateRange(
&nbsp;      @NotNull LocalDateTime startDate, @NotNull LocalDateTime endDate, Pageable pageable) {
<b class="fc">&nbsp;    logger.debug(&quot;Retrieving transactions between {} and {}&quot;, startDate, endDate);</b>
&nbsp;
<b class="fc">&nbsp;    if (startDate == null) {</b>
<b class="fc">&nbsp;      throw new ValidationException(&quot;startDate&quot;, &quot;start date cannot be null&quot;);</b>
&nbsp;    }
<b class="fc">&nbsp;    if (endDate == null) {</b>
<b class="fc">&nbsp;      throw new ValidationException(&quot;endDate&quot;, &quot;end date cannot be null&quot;);</b>
&nbsp;    }
<b class="fc">&nbsp;    if (startDate.isAfter(endDate)) {</b>
<b class="fc">&nbsp;      throw new ValidationException(&quot;dateRange&quot;, &quot;Start date cannot be after end date&quot;);</b>
&nbsp;    }
&nbsp;
<b class="fc">&nbsp;    return transactionRepository.findByDateRange(startDate, endDate, pageable);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Retrieves transactions by reference ID.
&nbsp;   *
&nbsp;   * @param referenceId the reference ID
&nbsp;   * @param pageable pagination information
&nbsp;   * @return page of inventory transactions
&nbsp;   */
&nbsp;  public Page&lt;InventoryTransaction&gt; getTransactionsByReferenceId(
&nbsp;      @NotNull String referenceId, Pageable pageable) {
<b class="fc">&nbsp;    logger.debug(&quot;Retrieving transactions for reference ID: {}&quot;, referenceId);</b>
&nbsp;
<b class="fc">&nbsp;    if (referenceId == null) {</b>
<b class="fc">&nbsp;      throw new ValidationException(&quot;referenceId&quot;, &quot;Reference ID cannot be null&quot;);</b>
&nbsp;    }
<b class="fc">&nbsp;    if (!StringUtils.hasText(referenceId)) {</b>
<b class="fc">&nbsp;      throw new ValidationException(&quot;referenceId&quot;, &quot;Reference ID cannot be empty&quot;);</b>
&nbsp;    }
&nbsp;
<b class="fc">&nbsp;    return transactionRepository.findByReferenceId(referenceId, pageable);</b>
&nbsp;  }
&nbsp;
&nbsp;  // ===== INVENTORY ANALYSIS OPERATIONS =====
&nbsp;
&nbsp;  /**
&nbsp;   * Calculates the total stock movement for a SKU within a date range.
&nbsp;   *
&nbsp;   * @param skuId the SKU ID
&nbsp;   * @param startDate the start date
&nbsp;   * @param endDate the end date
&nbsp;   * @return stock movement summary
&nbsp;   */
&nbsp;  public StockMovementSummary getStockMovementSummary(
&nbsp;      @NotNull Long skuId, @NotNull LocalDateTime startDate, @NotNull LocalDateTime endDate) {
<b class="fc">&nbsp;    logger.debug(</b>
&nbsp;        &quot;Calculating stock movement summary for SKU ID: {} between {} and {}&quot;,
&nbsp;        skuId,
&nbsp;        startDate,
&nbsp;        endDate);
&nbsp;
<b class="fc">&nbsp;    if (startDate.isAfter(endDate)) {</b>
<b class="fc">&nbsp;      throw new ValidationException(&quot;dateRange&quot;, &quot;Start date cannot be after end date&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    // Verify SKU exists
<b class="fc">&nbsp;    findSkuById(skuId);</b>
&nbsp;
<b class="fc">&nbsp;    List&lt;InventoryTransaction&gt; transactions =</b>
<b class="fc">&nbsp;        transactionRepository.findBySkuIdAndDateRange(skuId, startDate, endDate);</b>
&nbsp;
<b class="fc">&nbsp;    long totalIn = 0;</b>
<b class="fc">&nbsp;    long totalOut = 0;</b>
<b class="fc">&nbsp;    long totalAdjustments = 0;</b>
<b class="fc">&nbsp;    long totalReserved = 0;</b>
<b class="fc">&nbsp;    long totalReleased = 0;</b>
&nbsp;
<b class="fc">&nbsp;    for (InventoryTransaction transaction : transactions) {</b>
<b class="pc">&nbsp;      switch (transaction.getTransactionType()) {</b>
&nbsp;        case IN:
<b class="fc">&nbsp;          totalIn += transaction.getQuantity();</b>
&nbsp;          break;
&nbsp;        case OUT:
<b class="fc">&nbsp;          totalOut += transaction.getQuantity();</b>
&nbsp;          break;
&nbsp;        case ADJUSTMENT:
<b class="fc">&nbsp;          totalAdjustments += transaction.getQuantity();</b>
&nbsp;          break;
&nbsp;        case RESERVED:
<b class="fc">&nbsp;          totalReserved += transaction.getQuantity();</b>
&nbsp;          break;
&nbsp;        case RELEASED:
<b class="fc">&nbsp;          totalReleased += transaction.getQuantity();</b>
&nbsp;          break;
&nbsp;      }
&nbsp;    }
&nbsp;
<b class="fc">&nbsp;    return new StockMovementSummary(</b>
&nbsp;        totalIn, totalOut, totalAdjustments, totalReserved, totalReleased);
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Gets the current stock level for a SKU.
&nbsp;   *
&nbsp;   * @param skuId the SKU ID
&nbsp;   * @return current stock information
&nbsp;   */
&nbsp;  public CurrentStockInfo getCurrentStockInfo(@NotNull Long skuId) {
<b class="fc">&nbsp;    logger.debug(&quot;Getting current stock info for SKU ID: {}&quot;, skuId);</b>
&nbsp;
<b class="fc">&nbsp;    Sku sku = findSkuById(skuId);</b>
&nbsp;
<b class="fc">&nbsp;    return new CurrentStockInfo(</b>
<b class="fc">&nbsp;        sku.getStockQuantity(),</b>
<b class="fc">&nbsp;        sku.getReservedQuantity(),</b>
<b class="fc">&nbsp;        sku.getAvailableQuantity(),</b>
<b class="fc">&nbsp;        sku.getReorderPoint(),</b>
<b class="fc">&nbsp;        sku.getReorderQuantity(),</b>
<b class="fc">&nbsp;        sku.isLowOnStock(),</b>
<b class="fc">&nbsp;        sku.isOutOfStock());</b>
&nbsp;  }
&nbsp;
&nbsp;  // ===== PRIVATE HELPER METHODS =====
&nbsp;
&nbsp;  private Sku findSkuById(Long id) {
<b class="fc">&nbsp;    return skuRepository.findById(id).orElseThrow(() -&gt; new EntityNotFoundException(&quot;SKU&quot;, id));</b>
&nbsp;  }
&nbsp;
&nbsp;  private void validateTransactionParameters(Integer quantity, String operation) {
<b class="fc">&nbsp;    if (quantity == null || quantity &lt;= 0) {</b>
<b class="fc">&nbsp;      throw new ValidationException(&quot;quantity&quot;, operation + &quot; quantity must be positive&quot;);</b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  private void validatePerformerName(String performedBy) {
<b class="fc">&nbsp;    if (performedBy == null) {</b>
<b class="fc">&nbsp;      throw new ValidationException(&quot;performedBy&quot;, &quot;performer cannot be null&quot;);</b>
&nbsp;    }
<b class="fc">&nbsp;    if (performedBy.trim().isEmpty()) {</b>
<b class="fc">&nbsp;      throw new ValidationException(&quot;performedBy&quot;, &quot;performer cannot be empty&quot;);</b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  private void validateReferenceId(String referenceId) {
<b class="fc">&nbsp;    if (referenceId != null &amp;&amp; referenceId.length() &gt; 255) {</b>
<b class="fc">&nbsp;      throw new ValidationException(&quot;referenceId&quot;, &quot;reference ID too long&quot;);</b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  private void validateReason(String reason) {
<b class="fc">&nbsp;    if (reason != null &amp;&amp; reason.length() &gt; 1000) {</b>
<b class="fc">&nbsp;      throw new ValidationException(&quot;reason&quot;, &quot;reason too long&quot;);</b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  // ===== INNER CLASSES =====
&nbsp;
&nbsp;  /** Summary of stock movements for a SKU within a date range. */
&nbsp;  public static class StockMovementSummary {
&nbsp;
&nbsp;    private final long totalIn;
&nbsp;    private final long totalOut;
&nbsp;    private final long totalAdjustments;
&nbsp;    private final long totalReserved;
&nbsp;    private final long totalReleased;
&nbsp;    private final long netMovement;
&nbsp;
&nbsp;    public StockMovementSummary(
&nbsp;        long totalIn,
&nbsp;        long totalOut,
&nbsp;        long totalAdjustments,
&nbsp;        long totalReserved,
<b class="fc">&nbsp;        long totalReleased) {</b>
<b class="fc">&nbsp;      this.totalIn = totalIn;</b>
<b class="fc">&nbsp;      this.totalOut = totalOut;</b>
<b class="fc">&nbsp;      this.totalAdjustments = totalAdjustments;</b>
<b class="fc">&nbsp;      this.totalReserved = totalReserved;</b>
<b class="fc">&nbsp;      this.totalReleased = totalReleased;</b>
<b class="fc">&nbsp;      this.netMovement = totalIn - totalOut + totalAdjustments;</b>
&nbsp;    }
&nbsp;
&nbsp;    public long getTotalIn() {
<b class="fc">&nbsp;      return totalIn;</b>
&nbsp;    }
&nbsp;
&nbsp;    public long getTotalOut() {
<b class="fc">&nbsp;      return totalOut;</b>
&nbsp;    }
&nbsp;
&nbsp;    public long getTotalAdjustments() {
<b class="fc">&nbsp;      return totalAdjustments;</b>
&nbsp;    }
&nbsp;
&nbsp;    public long getTotalReserved() {
<b class="fc">&nbsp;      return totalReserved;</b>
&nbsp;    }
&nbsp;
&nbsp;    public long getTotalReleased() {
<b class="fc">&nbsp;      return totalReleased;</b>
&nbsp;    }
&nbsp;
&nbsp;    public long getNetMovement() {
<b class="fc">&nbsp;      return netMovement;</b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  /** Current stock information for a SKU. */
&nbsp;  public static class CurrentStockInfo {
&nbsp;
&nbsp;    private final int stockQuantity;
&nbsp;    private final int reservedQuantity;
&nbsp;    private final int availableQuantity;
&nbsp;    private final int reorderPoint;
&nbsp;    private final int reorderQuantity;
&nbsp;    private final boolean isLowOnStock;
&nbsp;    private final boolean isOutOfStock;
&nbsp;
&nbsp;    public CurrentStockInfo(
&nbsp;        int stockQuantity,
&nbsp;        int reservedQuantity,
&nbsp;        int availableQuantity,
&nbsp;        int reorderPoint,
&nbsp;        int reorderQuantity,
&nbsp;        boolean isLowOnStock,
<b class="fc">&nbsp;        boolean isOutOfStock) {</b>
<b class="fc">&nbsp;      this.stockQuantity = stockQuantity;</b>
<b class="fc">&nbsp;      this.reservedQuantity = reservedQuantity;</b>
<b class="fc">&nbsp;      this.availableQuantity = availableQuantity;</b>
<b class="fc">&nbsp;      this.reorderPoint = reorderPoint;</b>
<b class="fc">&nbsp;      this.reorderQuantity = reorderQuantity;</b>
<b class="fc">&nbsp;      this.isLowOnStock = isLowOnStock;</b>
<b class="fc">&nbsp;      this.isOutOfStock = isOutOfStock;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getStockQuantity() {
<b class="fc">&nbsp;      return stockQuantity;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getReservedQuantity() {
<b class="nc">&nbsp;      return reservedQuantity;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getAvailableQuantity() {
<b class="nc">&nbsp;      return availableQuantity;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getReorderPoint() {
<b class="fc">&nbsp;      return reorderPoint;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getReorderQuantity() {
<b class="fc">&nbsp;      return reorderQuantity;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean isLowOnStock() {
<b class="nc">&nbsp;      return isLowOnStock;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean isOutOfStock() {
<b class="nc">&nbsp;      return isOutOfStock;</b>
&nbsp;    }
&nbsp;  }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2025-07-19 20:52</div>
</div>
</body>
</html>
